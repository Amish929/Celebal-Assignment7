Task: Apply triggers in build and release.
ðŸŽ¯ Objective:

âœ… Auto-trigger a build when code is pushed to a specific branch (CI trigger)

âœ… Auto-trigger a release when build completes successfully (CD trigger)


 Self-Hosted Agent (on your local Windows PC)

ðŸ› ï¸ STEP-BY-STEP: Set Up a Self-Hosted Agent on Windows
ðŸ”¹ 1. Go to Azure DevOps > Agent Pools
Visit: https://dev.azure.com

Go to your Project

Click on Project Settings (bottom-left corner)

Under Pipelines, click Agent Pools

Click on Default (or create a new pool if you want)


ðŸ”¹ 2. Click â€œNew Agentâ€ Button
On the top right, click "New Agent"

Choose:

OS: Windows

Click Download to get the agent ZIP file

ðŸ”¹ 3. Extract and Configure the Agent
Extract the ZIP to a folder like:C:\azagent

Open Command Prompt as Administrator

Navigate to the agent folder:cd C:\azagent

Run the configuration script:config.cmd

When prompted:
Server URL:https://dev.azure.com/YOUR_ORG/

PAT (Personal Access Token):
ðŸ‘‰ Follow the prompt to create a PAT from Azure DevOps with Agent Pools (Read & manage) permission

Agent Name: Keep default or name it like mywindowsagent

Work folder: Default is fine

ðŸ”¹ 4. Run the Agent
After setup:run.cmd

ðŸ’¡ Leave this window open â€” it will now receive jobs from your Azure pipeline.

ðŸ”¹ 5. Update Your YAML to Use Self-Hosted Agent
Edit your YAML pipeline to use your new agent:
trigger:
  branches:
    include:
      - master

pool:
  name: Default  # your self-hosted agent pool

stages:
- stage: Build
  jobs:
  - job: BuildJob
    steps:
    - script: echo "âœ… Code built successfully"

- stage: Release
  dependsOn: Build
  jobs:
  - deployment: ReleaseToProd
    environment: 'production'
    strategy:
      runOnce:
        deploy:
          steps:
          - script: echo "ðŸš€ Release deployed"


ðŸ”§ PART 1: Apply Build Trigger (CI)
This is done using the trigger block in your azure-pipelines.yml.

âœ… Step 1: Open Your Azure Pipeline
Go to https://dev.azure.com

Select your Project

Go to Pipelines > Pipelines

Click your pipeline â†’ Edit


âœ… Step 2: Add CI Trigger in YAML
    Update the top of your YAML file like this:
trigger:
  branches:
    include:
      - master

ðŸ“Œ This will automatically trigger the build whenever you push to the master branch.
âœ… Step 3: Save and Test CI Trigger
Click â€œSave and Runâ€

Then make a small code change in the repo (e.g., edit README.md)

Commit and push to the master branch

âœ… Build will start automatically!

ðŸ”§ PART 2: Apply Release Trigger (CD) Using Environments
Weâ€™ll use Environments + Approvals to simulate a release pipeline.

âœ… Step 4: Create Environment for Release
Go to Pipelines > Environments

Click + New environment

Name it:production

Click Create
âœ… Step 5: Add Release Stage to YAML.

ðŸ“Œ This makes the Release stage auto-trigger after the build completes successfully â€” which is your CD trigger.

ðŸ”¹ 6. Save and Run Your Pipeline
Go to Pipelines > Pipelines

Edit and click Save and Run

Your self-hosted agent will now pick up the job and execute it!